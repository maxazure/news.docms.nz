# Claude Code: 代理式编程最佳实践

> 来自 Anthropic 最新文章

## 什么是 Claude Code？

Claude Code 是一个灵活、低层次的命令行工具，提供接近原始模型的访问权限，支持自定义和脚本化，适合各种代码库、语言和环境。它不强制特定工作流程，但需要用户摸索适合自己的使用方法。

---

## 💡 最佳实践

### 1. 自定义设置

#### · CLAUDE.md 文件

- 在存储库根目录创建 `CLAUDE.md`，记录常用命令、核心文件、代码风格、测试说明等  
- 可加入 Git 共享给团队，或命名为 `CLAUDE.local.md` 并加入 `.gitignore` 忽略提交  
- 优化内容以提高 Claude 的指令遵循性（可用提示改进器调整）

#### · 工具权限

- 默认需手动授权修改系统的操作（如文件写入、bash 命令）  
- 可通过会话内“始终允许”、`/allowed-tools` 命令、编辑配置文件或 CLI 标志进行管理

---

### 2. 扩展 Claude 的工具

#### · Bash 工具

- Claude 继承你的 Bash 环境，可通过示例、运行 `--help` 或记录在 `CLAUDE.md` 中教会它使用自定义工具

#### · MCP

- 作为客户端连接 MCP 服务器，访问更多工具  
- 可通过配置文件或 `.mcp.json` 管理

#### · 自定义斜杠命令

- 在 `.claude/commands/` 文件夹中存储提示模板（如 Markdown 文件）  
- 通过 `/` 调用命令，支持参数传递（如 `$ARGUMENTS`）

---

### 3. 常见工作流程

- **探索、计划、编码、提交**：让 Claude 阅读文件、制定计划、编写代码并提交  
- **测试驱动开发（TDD）**：先写测试，确认失败，再写代码通过测试  
- **视觉迭代**：提供设计目标（如截图），让 Claude 迭代直到匹配  
- **YOLO 模式**：使用 `--dangerously-skip-permissions` 跳过权限检查，适合快速修复 lint 错误（建议在隔离容器中运行）  
- **代码库问答**：询问代码相关问题，快速学习新项目  
- **Git 和 GitHub 集成**：处理 Git 操作（如提交历史、消息）和 GitHub 任务（如创建 PR、修复评论）

---

### 4. 优化工作流程

- **具体指令**：详细说明需求，避免模糊  
- **提供素材**：粘贴图片、URL 或用制表符补全引用文件  
- **及时调整**：提前规划、中断或撤销操作，保持方向正确  
- **清理上下文**：使用 `/clear` 重置无关内容  
- **复杂任务**：使用 Markdown 文件作为清单或便笺  
- **数据输入**：支持粘贴、管道、读取文件或 URL

---

### 5. 无头模式

- 使用 `-p` 标志启用非交互模式，适合 CI、钩子等自动化任务  
- 输出可用 `--output-format stream-json` 格式化

---

### 6. 多 Claude 协作

- **分工**：一个写代码，另一个审查或测试  
- **多检出**：在不同文件夹运行多个 Claude，分配任务  
- **Git worktrees**：在同一存储库检出多分支并行工作  
- **自动化集成**：用无头模式嵌入大型工作流程